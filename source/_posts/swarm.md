---
title: swarm 教程
date: 2019-04-03 11:38:07
tags:
categories:
- 设施
- 容器
---
Docker Swarm是Docker官方三剑客项目之一，提供Docker容器集群服务，是Docker官方对容器云生态进行支持的核心方案。使用它，用户可以将多个Docker主机抽象为大规模的虚拟Docker服务，快速打造一套容器云平台。
<!-- more -->
## swarm简介
## 基本概念
Swarm在Docker基础上扩展了支持多节点的能力，同时兼容大部分的Docker操作。Swarm中以集群为单位进行管理，支持服务层面的操作。
下面首先介绍Swarm使用中的一些概念。
### 1.Swarm集群
Swarm集群（Cluster）是一组被统一管理的Docker主机。这些主机通过Docker引擎的Swarm模式相互沟通，其中部分主机作为管理节点相应外部的管理请求，其他主机作为工作节点来实际运行Docker容器。同一个主机可同时作为管理节点和工作节点。
用户要使用Swarm集群，首先要定义一个服务，然后通过管理节点发出启动服务的指令，管理节点随后会按照指定的服务规则进行调度，在集群中启动整个服务。
### 2.节点
节点（node）是Swarm集群的最小资源单位。每个节点代表一台Docker主机。
Swamp集群中的节点分为两种
* 管理节点（manager）：负责相应外部对集群的操作请求
* 工作节点（worker）：负责执行管理节点的具体任务

用户可以通过docker node promote命令来提升一个工作节点为管理节点；docker node demote命令将一个管理节点降级为工作节点。
### 3.服务
Service是docker支持复杂多容器协作的工具
一个服务有若干任务组成，每个任务为具体的应用。服务还包括对应的存储、网络、端口映射、副本个数、访问配置、升级配置等附加参数。
Swarm集群中的服务模式包括两种：
* 复制服务模式：默认模式，
* 全局服务模式：调度器将在每个节点都执行一个相同任务。该模式适合运行节点的检查，如监控应用等。

### 4.任务
即一个容器
### 5.服务的外部访问
## 使用swarm
集群的主要操作，包括
* swarm init：在管理节点创建一个集群
* swarm list：列出节点中集群信息
* swarm join：加入一个节点到已有集群
* swarm update：更新集群
* swarm leave：离开集群

### 1.创建集群
### 2.查看集群信息
### 3.加入进群
### 4.使用集群服务
使用集群服务有两种方式：
* 使用docker原来的docker的命令，需要通过-H <manager>:2377选项指定管理服务
* 使用docker service命令

### 5.更新集群
### 6.离开集群
节点任何时刻都可通过swarm leave脱离集群
## 使用服务命令
